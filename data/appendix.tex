% !TeX root = ../thuthesis-example.tex

\chapter{补充内容}

%附录是与论文内容密切相关、但编入正文又影响整篇论文编排的条理和逻辑性的资料，例如某些重要的数据表格、计算程序、统计表等，是论文主体的补充内容，可根据需要设置。


\section{定理\ref{thm:DPX}的证明}

\begin{lemma}\label{lem:xyz}
	若 $(X,Y)$ 与 $Z$ $\epsilon$-弱独立，
  则 $X$ 与 $Z$ $\epsilon$-弱独立。
\end{lemma}
\begin{proof}
	由两随机变量$\epsilon$-弱独立的定义式\ref{def:weak_indepedent}，
  我们有
	\begin{equation}\label{eq:pxy_eps}
	P_{X,Y|Z=z}(x,y) = P_{X,Y}(x,y)\left(1+\epsilon \frac{\phi_z(x,y)}{\sqrt{P_{X,Y}(x,y)}}
  \right), z \in \mathcal{Z}
	\end{equation}
	对式\ref{eq:pxy_eps} 关于 $y\in \mathcal{Y}$ 求和我们有
	\begin{equation}
	P_{X|Z=z}(x) = P_X(x)\left(1+\epsilon\frac{\tilde{\phi}_z(x)}{\sqrt{P_X(x)}} \right),
	\textrm{ 其中 } \tilde{\phi}_z(x) = \frac{\sum_{y\in \mathcal{Y}} \sqrt{P_{X,Y}(x,y) }\phi_z(x,y)}{\sqrt{P_X(x)}}
	\end{equation}
	由 柯西不等式, $||\tilde{\phi}_z(x)||^2 \leq \frac{1}{P_X(x)}
	\sum_{y\in \mathcal{Y}}(P_{X,Y}(x,y))
	\sum_{y\in \mathcal{Y}} \phi_z^2(x,y) \leq 1
	$
	从而推出 $X$  与 $Z$ 弱独立。
\end{proof}
\begin{proof}[定理\ref{thm:DPX}的证明]
  由多个随机变量弱独立的定义式 \ref{def:general},
  我们可以找到 一个在字母集 $\{1, 2,\dots, K\}$上的
  离散分布 $U$, 使得 $Z_1, \dots, Z_n$
  关于 $U$ 条件独立。不失一般性，我们假设
  $(Z_1, \dots, Z_n)$ $\epsilon^n$-弱独立。
  则 $(Z_1, \dots, Z_n)$ 和 $U$ $\epsilon$-弱独立，
  由引理 \ref{lem:xyz} 可得 $Z_i$
  和 $U$ $\epsilon$-弱独立，也即有 
\begin{equation}\label{XUk}
P_{Z_i | U=k}(z) = P_{Z_i} (z) \left( 1 + \epsilon {\phi^{(k,i)}(z) \over \sqrt{P_{Z_i}(z)}} \right)
\end{equation}
利用条件独立有
\begin{align}
P_{Z_i, Z_j | U = k}(z_i, z_j)
=& P_{Z_i | U=k}(z_i)
P_{Z_j | U=k}(z_j) \notag \\
=& P_{Z_i}(z_i)P_{Z_j}(z_j)
\left(1 + \epsilon
\left(\frac{\phi^{(k,i)}(z_i)}{\sqrt{P_{Z_i}(z_i)}}
+ \frac{\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_j}(z_j)}}
\right) +
\epsilon^2\frac{\phi^{(k,i)}(z_i)
	\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
  \right)
  \label{eq:XiXj}
\end{align}
又因为
\begin{align*}
P_{Z_i}(z) &= \sum_{k=1}^{K} P_{Z_i | U=k}(z) P_U(u_k) \\
& =  \sum_{k=1}^{K}P_U(u_k)P_{Z_i} (z)
\left( 1 + \epsilon {\phi^{(k,i)}(z) \over \sqrt{P_{Z_i}(z)}} 
\right) \textrm{ from } \eqref{XUk}\\
\Rightarrow & \sum_{k=1}^{K} P_U(u_k){\phi^{(k, i)}(z) \over \sqrt{P_{Z_i}(z)}} =0,\forall i, z\in \mathcal{Z}
\end{align*}
因此 \eqref{eq:XiXj} 化简为
\begin{equation}\label{eq:PXiXj}
P_{Z_i, Z_j}(z_i, z_j) = P_{Z_i}(z_i)
P_{Z_j}(z_j) \left(
  1+\epsilon^2 \sum_{k=1}^K P_U(u_k)
\frac{\phi^{(k,i)}(z_i)
	\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
  \right)
\end{equation}
对于2个以上的随机变量:
\begin{align*}
P_{Z_1,\dots,Z_n}(z_1,\dots,z_n)  &= \sum_{k=1}^{K} P_{Z_1,\dots,Z_n | U=k}(z_1,\dots,z_n) P_U(u_k) \\
&=  \sum_{k=1}^{K}P_U(u_k) \prod_{i=1}^n P_{Z_i|U=k}(z_i)\\
&= \sum_{k=1}^{K} P_U(u_k)\prod_{i=1}^n \left(P_{Z_i} (z_i)( 1 + \epsilon {\phi^{(k,i)}(z_i ) \over \sqrt{P_{Z_i}(z_i)}} )\right)\\
&=  \sum_{k=1}^{K}P_U(u_k) (\prod_{i=1}^n  P_{Z_i} (z_i))
\left( 1 + \epsilon\sum_{i=1}^n {\phi^{(k,i)}(z_i) \over \sqrt{P_{Z_i}(z_i)}} + \epsilon^2\sum_{i\neq j}{\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)+o(\epsilon^2) \\
&= (\prod_{i=1}^n  P_{Z_i} (z_i))
\Big(1+\epsilon\sum_{i=1}^n \sum_{k=1}^{K} P_U(u_k){\phi^{(k,i)}(z_i) \over \sqrt{P_{Z_i}(z_i)}} \\
&+\epsilon^2 \sum_{k=1}^{K} P_U(u_k)\sum_{i\neq j}{\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } 
\Big) + o(\epsilon^2)\\
&= (\prod_{i=1}^n  P_{Z_i} (z_i))
\left(1 +\epsilon^2\sum_{i\neq j} \sum_{k=1}^{K}P_U(u_k){\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right) + o(\epsilon^2)
\end{align*}
由 \eqref{eq:PXiXj},
令 $B_{ij}(z_i, z_j)={P_{Z_i, Z_j}(z_i,z_j) - P_{Z_i}(z_i)P_{Z_j}(z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}} $ 可得:
\begin{align}
\epsilon^2\sum_{k=1}^{K}P_U(u_k)
{\phi^{k,i}(z_i)\phi^{k,j}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } & = {P_{Z_i, Z_j}(z_i, z_j) - P_{Z_i}(z_i)P_{Z_j}(z_j) \over P_{Z_i}(z_i)P_{Z_j}(z_j)} \notag\\
& = {B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } \label{eq:Bsecond}
\end{align}
因此，我们有
\begin{equation}\label{eq:sep}
P_{Z_1,\dots,Z_n}(z_1,\dots,z_n) =  (\prod_{i=1}^n  P_{Z_i} (z_i))\left ( 1 + \sum_{i\neq j}{B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right) +o(\epsilon^2)
\end{equation}
因此 $P_{Z_1,\dots, Z_n}$ 在 $P_{Z_1}\dots P_{Z_n}$ 的
$\epsilon$ 邻域内，且特征函数是
$$\phi(z_1,\dots, z_n)=
\sqrt{P_{Z_1}(z_1)\dots P_{Z_n}(z_n)}
\left(\sum_{i\neq j}{B_{ij}(z_i, z_j) 
\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)
+o(\epsilon^2)$$

由 信息几何的式\eqref{eq:approx:ig} 可得
\begin{align*}
D(P_{Z_1,\dots, Z_n}|| P_{Z_1}\dots P_{Z_n}) & ={1 \over 2} \sum_{z_1,\dots,z_n}\phi^2(z_1,\dots, z_n) \\
& = {1\over 2}\sum_{z_1,\dots,z_n} (\prod_{i=1}^n  P_{Z_i} (z_i)) \left(\sum_{i\neq j}{B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)^2 +o(\epsilon^2) 
\end{align*}
由 $B_{ij}$
的定义式 \eqref{eq:Ixy}，
上式可化为对 $\norm{B_{ij}}^2_F$
的求和(平方和中的交叉项外面再求和得零)。
因此，对于分割$\P=\{\{i\},i\in V\}$ 我们得到
\begin{equation}
D(P_{Z_1,\dots, Z_n}|| P_{Z_1}\dots P_{Z_n}) =   {1 \over 2} \sum_{i\neq j} \norm{B_{ij}}^2_F + o(\epsilon^2)
\end{equation}
对于任意的分割 $\P$，
由式\eqref{eq:sep}可得，对于 $C\in \P$，
我们有
\begin{equation}
P_{Z_C}(z_C) = \prod_{i\in C} P_{Z_i}(z_i)
\left(1 + \epsilon^2 \sum_{i\neq j,i,j\in C} \frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
\right) + o(\epsilon^2)
\end{equation}
将上式相乘可得:
\begin{equation}
\prod_{C\in \P}P_{Z_C}(z_C) = \prod_{i=1}^n P_{Z_i}(z_i)
\left(1+\epsilon^2 \sum_{C\in\P}\sum_{i\neq j,i,j\in C}\frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
\right) + o(\epsilon^2)
\end{equation}
所以 $\prod_{C\in \P}P_{Z_C}$ 在 $P_{Z_1}\dots P_{Z_n}$ 的$\epsilon$ 邻域内，
且 $$\phi_{\P}(z_1,\dots, z_n)=
\sqrt{P_{Z_1}(z_1)\dots P_{Z_n}(z_n)}\left(\sum_{C\in\P}\sum_{i\neq j,i,j\in C}\frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}\right)+o(\epsilon^2)$$
由  \eqref{eq:approx:ig} 得:
\begin{align*}
D(P_{Z_1,\dots, Z_n}|| \prod_{C\in \P}P_{Z_C}) & ={1 \over 2} \sum_{z_1,\dots,z_n}(\phi(z_1,\dots, z_n)-\phi_{\P}(z_1, \dots, z_n))^2 \\
& = {1\over 2}\sum_{z_1,\dots,z_n} \prod_{i=1}^n  P_{Z_i} (z_i) \left(\sum_{\substack{(i,j) \not\in C\\ C\in \P}} {B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)^2 +o(\epsilon^2) \\
& = \frac{1}{2} \sum_{\substack{(i,j) \not\in C\\ C\in \P}} \norm{B_{ij}}_F^2 + o(\epsilon^2)
\end{align*}
\end{proof}



\section{定理\ref{thm:triangle} 的证明}
首先我们证明如下引理：
\begin{lemma}\label{thm:trival}
  分割 $\P_k = \{\{1\},\{2\},\dots,\{\abs{V}\}\}$ 
  使得 $\frac{f[\P]}{\abs{\P}-1}$
  最小 当且仅当 条件\eqref{eq:GF} 成立。
  \begin{equation}\label{eq:GF}
  \frac{f[\P]}{\abs{\P}-1} \geq \frac{f[\P_k]}{\abs{V}-1} \textrm{ for any } \P \in \Pi'
  \end{equation}
  \end{lemma}
  \begin{proof}
  由\citet{narayanan} 的定理3可知，
  $h(\lambda)$ 是分段线性函数，
  $h(\lambda)$ 的第一段
  是 $ - \lambda $ 且 
  最后一段是 $ f[\P_k] - \abs{V} \lambda$。
  它们的交点是
  $(\lambda_{+}, -\lambda_{+})$，
  其中
  $\lambda_{+} = \frac{f[\P_k]}{\abs{V}-1}$。
  因为 $\frac{f[\P]}{\abs{\P}-1} \geq \lambda_{+} \iff f[\P] - \abs{\P}\lambda_{+} \geq - \lambda_{+}$，
  方程 \eqref{eq:GF}
  相当于说 $h(\lambda)$ 在 $\lambda = \lambda_{+}$
  的最小值点是
  $\{V\}$ 或
  $\{\{1\},\{2\},\dots,\{\abs{V}\}\}$
  并且 $h(\lambda)$ 只有两段。
  从几何的观点来看，$\min\frac{f[\P]}{\abs{\P}-1}$
  是 $h(\lambda)$ 第一个分界点，
  该分界点与$h(\lambda)$最后一个分界点
  相等 当且仅当 \eqref{eq:GF} 成立。
  \end{proof}
  \begin{proof}[定理\ref{thm:triangle} 的证明]
    我们将使用归纳法证明对于任意的分割$\P \in \Pi$，
    式\eqref{eq:GF} 成立。
    \begin{equation}\label{eq:GF}
    f[\P] \geq \frac{\abs{\P}-1}{\abs{V}-1} \sum_{(i,j) \in E} w_{ij}
    \end{equation}
    
    然后由引理 \ref{thm:trival}
    即可得证。
    
    设 $n=\abs{V}$。
    若 $\abs{\P}=n$，
    易得式 \eqref{eq:GF} 取等号。
    
    假设 式\eqref{eq:GF} 对 任意
    $\abs{\P} \geq k+1(k\geq 2)$成立，
    下面我们讨论 $\P=\{C_1, \dots, C_k\}$
    的情形。
    因为$\P$是非平凡的分割，
    因此存在某个$\abs{C_i}\geq 2$。
    不妨设$\abs{C_1}=n_1\geq 2$，
    构造$\P$的一个细分$\P'$如下：
    $\P_{C_1} = \{\{i\}| i \in C_1\}, \P'=\P_{C_1} \cup \P \backslash \{C_1\}$。
    则我们有 $\abs{\P'} = k+n_1-1$。
    对$\P'$运用 式\eqref{eq:GF} 有
    \begin{align}\label{eq:PPrelation}
    f[\P'] &
    \geq \frac{k+n_1 -2}{n-1}\sum_{(i,j) \in E} w_{ij} \\
    f[\P] & =f[P'] - \sum_{(i,j) \in E(C_1)} w_{ij}
    \end{align}
    其中
    $E(C_1) =\{ (i,j) |i<j, i, j\in C_1 \}$。
    对任意$k \not\in C_1$运用三角不等式
    $w_{ij} \leq w_{ik} + w_{jk}$，
    并关于所有 $i, j \in C_1, i\neq j$求和，
    我们有
    $$
    \sum_{(i,j) \in E(C_1)} w_{ij} \leq \sum_{(i,j) \in E(C_1)} (w_{ik} + w_{jk}) = (n_1-1)\sum_{i\in C_1} w_{ik}
    $$
    再将上式对所有 $k \not\in C_1$ 求和
    $$
    (n - n_1) \sum_{(i,j) \in E(C_1)} w_{ij} \leq (n_1 - 1) \sum_{i \in C_1, k \not\in C_1} w_{ik}
    $$
    另外，注意到
    \begin{align*}
    \sum_{(i,j) \in E} w_{ij}  & \geq \sum_{(i,j) \in E(C_1)} w_{ij} + \sum_{i\in C_1, k\not\in C_1} w_{ik} \\
    (n_1 - 1)\sum_{(i,j) \in E} w_{ij}  & \geq (n_1 -1 )\sum_{(i,j) \in E(C_1)} w_{ij} + (n_1-1)\sum_{i\in C_1, k\not\in C_1} w_{ik} \\
    & \geq (n_1 -1 )\sum_{(i,j) \in E(C_1)} w_{ij} + (n - n_1) \sum_{(i,j) \in E(C_1)} w_{ij}\\
    & = (n-1) \sum_{(i,j) \in E(C_1)} w_{ij}
    \end{align*}
   因此我们得到 $\sum_{(i,j) \in E(C_1)} w_{ij} \leq \frac{n_1-1}{n-1}\sum_{(i,j) \in E} w_{ij}$。
   从式 \eqref{eq:PPrelation} 可得
    $f[\P] \geq \frac{k-1}{n-1}\sum_{(i,j) \in E} w_{ij}$。
    因此，结论对 $\abs{\P}=k$ 成立。
    \end{proof}
\section{定理 \ref{thm:alg_complexity} 的证明}
\begin{proof}[定理 \ref{thm:alg_complexity} 的证明]
  令
  $\mu_i = \frac{n_i}{n} \leq \frac{1}{2}$。
  下面我们使用归纳法证明
  $T(n) = O(n^4)$。
  更具体地，我们将证明 
  $T(n) \leq q C n^4$， 其中 $ q = \frac{16}{5}$。
  $T(3)$ 是一个常数，我们取$C$使得 $T(3)= q C\times 3^4$。
  下面假设
	$T(m) \leq qC m^4$
  对所有 $m \leq n-1$。
  然后 对于 $T(n)$，
	我们首先证明下式成立：
	\begin{equation}\label{eq:outerI}
	\sum_{i=1}^k T(n_i) \leq 10 T(\frac{n}{2})
	\end{equation}
	因为 $\sum_{i=1}^k T(n_i) \leq qC n^4\sum_{i=1}^k u_i^4$ 并且
  从式 \eqref{eq:Tn} 中可得
  $10 T(\frac{n}{2}) \geq 10Cn^4 (\frac{1}{2})^4$ 
	\begin{equation}\label{eq:innerI}
       q\sum_{i=1}^k u_i^4 \leq 10 (\frac{1}{2})^4 
	\end{equation}
	所以我们有 \eqref{eq:innerI} $\Rightarrow$ \eqref{eq:outerI}。
  由定理 \ref{thm:alg_complexity} 条件，我们不妨假设
  $u_1\leq u_2 \leq \dots \leq u_k \leq \frac{1}{2}$
  且 $\sum_{i=1}^k u_i = 1$。
  因此，我们有
  $u_1 \leq \frac{1}{k}, u_2 \leq \frac{1}{k-1}, \dots, u_{k-1} \leq \frac{1}{2}$。
	根据
  \begin{equation}\label{eq:outerOne}
	 q[2(\frac{1}{2})^4 + \sum_{i=3}^k (\frac{1}{i})^4] \leq 10 (\frac{1}{2})^4
	\end{equation}
	我们有 \eqref{eq:outerOne} $\Rightarrow$ \eqref{eq:innerI}。
  并且代入$q=\frac{16}{5}$，
  \eqref{eq:outerOne} 等价于
	$\sum_{i=3}^k (\frac{1}{i})^4 \leq \frac{9}{8}(\frac{1}{2})^4$
	\begin{align*}
		\sum_{i=3}^k (\frac{1}{i})^4 & < \frac{1}{9}\sum_{i=3}^k \left(\frac{1}{i}
    \right)^2 \\
		& < \frac{1}{9}\sum_{i=3}^k \frac{1}{i(i-1)} \\
		& < \frac{1}{18}
    < \frac{9}{8}\left(\frac{1}{2}
    \right)^4
	\end{align*}
	因此，
  式 \eqref{eq:outerI} 成立。然后
  由 式\eqref{eq:Tn} 和 $T(k) \leq T(\frac{n}{2})$ 可得
	\begin{align}
		T(n)  & \leq Cn^4 + 11T\left(\frac{n}{2} \right) \\
		& \leq C n^4 + 11 q C \left(\frac{n}{2}\right)^4
    = \frac{16}{5} C n^4
	\end{align}
\end{proof}
\section{定理\ref{thm:main_N}的证明}
    \begin{proof}[定理\ref{thm:main_N}的证明]
      我们首先做出如下的符号约定：
      $w(C) = \displaystyle\sum_{(i,j) \in E(C)} w_{ij},$
      $w(A, C) = \displaystyle\sum_{\substack{i \in A, j \in C \\ (i,j) \in E(V')}} (w_{ij}+w_{ji})$ and
      $\P_C = \{\{i \}| i \in C \}$。
      假设 $\gamma_N = I(Z_B)$，
      由式 \eqref{eq:largest_threshold} 可得
      $\gamma_N =\frac{f[\P_B]} {\abs{B} -1}$。
      因为 $V' = B \cup \{i'\}$，我们有
      $f[\P_{V'}] = f[\P_B] + \sum_{i \in B}w_{ii'}$。
      
      若 $ \sum_{i \in B} w_{ij} > \gamma_N$， 我们可得
      $$
      \gamma'_N \geq I_{\P_{V'}}(Z_{V'}) = \frac{(\abs{B}-1)\gamma_N
      + \sum_{i \in B}w_{ii'}}{\abs{B}} > \gamma_N
      $$
      
      另一方面， 假设 
      $\gamma'_N = I(Z_K) > \gamma_N$。 则 $K$ 必包含 $i'$。
      若 $K=V'$， 则结论成立。
      否则， 假设 $K = \{i'\} \cup B', B=B'\cup J, J\neq \emptyset$，
      则我们有
      \begin{equation}\label{eq:gammaNF}
      \gamma_N = \frac{w(J,B') + w(J) + w(B')}{ \abs{B'} + \abs{J} - 1 }
      \end{equation}
      因为 $I(Z_K) = I_{\P_K}(Z_K)$ 是最大的，
      我们有 $I_{\P_K}(Z_K) > I_{\P_{V'}}(Z_{V'})$ 且
      $I_{\P_K}(Z_K) \geq I_{\P_{B'}}(Z_{B'})$。
      \begin{align*}
      \frac{w(\{i'\}, B') + w(B')}{\abs{B'}} >& \frac{w(B') + w(J, B') + w(J) + w(\{i'\}, B') + w(\{i'\}, J)}{\abs{B'} + \abs{J}}  \\
      \frac{w(\{i'\}, B') + w(B')}{\abs{B'}} \geq & \frac{w(B')}{\abs{B'} - 1}
      \end{align*}
      于是可得
      \begin{align}
      \abs{J} \left(w(\{i'\}, B') + w(B') \right) > &
      \abs{B'} \left(w(J, B') + w(J) + w(\{i'\}, J) \right)
      \label{eq:target}
      \\
      (\abs{B'} - 1)  w(\{i'\}, B') \geq & w(B') \label{eq:convert}
      \end{align}
      将 式\eqref{eq:convert} 代入 式\eqref{eq:target} 可得
      \begin{equation}\label{eq:summation}
      \abs{J} w(\{i'\}, B') > w(J, B') + w(J) + w(\{i'\}, J)
      \end{equation}
      结合 式\eqref{eq:gammaNF}，
      将 式\eqref{eq:convert} 与 式\eqref{eq:summation} 相加我们可得
      $w(\{i'\}, B') > \gamma_N$。
      所以 $\sum_{j \in B}w_{ii'} > \gamma_N $ 成立。
    \end{proof}
  
\section{数据集}

\subsection{数据聚类数据集}
Gaussian 数据集是用\texttt{scikit-learn}
\cite{scikit-learn}
的 make\_blobs 函数生成，每类25个数据点，共4类。
其中心分别为$[3,3],[-3,-3],[3,-3],[-3,3]$，
标准差均为1。

Circle 数据集共3类，每一类的数据点个数分别为 $[60,100,140]$，
并使用如下的极坐标公式生成：
\begin{align*}
r &= 0.1 \times i + 0.01(2u-1), i = 1, 2, 3\\
\theta & = 2\pi v
\end{align*}
其中 $u,v$ 是 $[0,1]$ 间的随机数，彼此独立。

\subsection{PSP算法性能比较所用数据集}
Gaussian-blob 数据集与 Gaussian 数据集
的区别在于每类$n$个数据点，其中$n=[1,2,3,4,5]*100$。

Two-level graph 数据集中取参数
$z_{\mathrm{in}_1}=s^2-2,
z_{\mathrm{in}_2}=s-1,
z_{\mathrm{out}}=1$，其中$s=[3,4,5,6,7]$。
\subsection{异常值检测所用数据集}
GaussianBlob 数据集 共有 300 个点，
其中 有 15\% 的点采样自 $[-6,6]\times [-6,6]$
内的均匀分布，为异常值点。其余的点采样自标准差为0.5，
中心在原点的 二维高斯分布， 为正常值点。

Moon 数据集类似 GaussianBlob 数据集， 共有 345 个点，
其中 有45 个点采样自 $[-6,6]\times [-6,6]$，经过个别点的坐标修正
后视为异常值点，
其余的点用 scikit-learn 的 make\_moons 函数生成，并做适当的
伸缩变换后视为正常值点。

Lymphography 数据集共148个数据点，
分成4类，因为第1和第4类总共有6个数据点，被视为异常值点，
其余的点为正常值点。

Glass 数据集在数据聚类中用到过，这里因为其第6个类别的点数量最少，
视其为整体的异常值点，而其他数据点为正常值点。

Ionosphere 数据集经常预处理后共 351个数据点，特征的维度为32，
其中 126个为异常值点。

\section{算法超参数}
\subsection{聚类算法}
在表\ref{tab:clustering_dataset}对应的实验中，
除信息聚类算法外，我们使用 scikit-learn 算法包提供
的接口，各算法的超参数如表\ref{tab:clustering_alg_hyperparameter}
所示。
系统聚类法（AgglomerativeClustering）统一使用欧式距离，
谱聚类(SpectralClustering)
统一使用 k近邻（8）计算相似度矩阵，括号中的数字表示
邻居节点的数量。
近邻传播和信息聚类的相似度矩阵因数据集而异。
这里，我们允许信息聚类取rbf和k近邻
两种相似度度量的复合，即它们数值的相乘。
表中 rbf 度量和 laplacian 度量
后面括号中的参数 $\gamma$的含义与
式 \ref{eq:rbf_kernel} 相同。
针对系统聚类和信息聚类两个层次聚类算法，
为获得非层次聚类结果，需要指定相应的超参
从聚类树中抽取局部的聚类结果，这里为方便
起见，我们给出抽取后的类别数作为派生的超参。

\begin{table}[!ht]
  \begin{adjustbox}{width=\columnwidth,center}
  \begin{tabular}{|l|r|r|r|r|r|r|}
  \hline
   聚类算法  &   参数名称 & Gaussian &   Circle &   Iris &   Glass &   Libras \\
  \hline
   \multirow{2}{*}{系统聚类法}  &  linkage     &   complete&     single &   average
   & ward &   complete \\
   \cline{2-7}
   & 类别数 & 4 & 3 & 3 & 7 & 15 \\
   \hline
   \multirow{3}{*}{近邻传播}  &    affinity & euclidean &  k近邻(16)
   &  k近邻(10)
   & euclidean &   euclidean \\
   \cline{2-7}
   & preference & -50 & 50 & 50 &
   -50 & -50\\
   \cline{2-7}
   & 衰减系数 & 0.5 & 0.8 & 0.5 & 0.8 & 0.5 \\
   \hline
   \multirow{2}{*}{信息聚类}  & 
   \multirow{2}{*}{affinity}      &       rbf(0.4) &    rbf(0.01)&  laplacian(8) & k近邻(14) &   rbf(0.2) \\
   & & &  k近邻(16)  & && k近邻(4)\\
   \cline{2-7}
   & 类别数 & 4 & 3 & 3 & 42 & 38\\
   \hline
   k-平均算法     &     类别数    &
   4 &    3 &  3 &   6 &    15 \\
   \hline
   谱聚类   &    类别数 & 4 &   3 &    3 &   6 &    15 \\
  \hline
  \end{tabular}
  \end{adjustbox}
\caption{聚类算法超参数}\label{tab:clustering_alg_hyperparameter}
\end{table}

另外，在图\ref{fig:shc}对应的实验中。系统聚类法我们使用 scipy 算法包中的 linkage 来完成。
对于贝叶斯玫瑰树算法，
%参考了xxx的开源实现，
混合比例取 $\alpha=0.5$且先验分布是
正态逆威沙特 （Normal-inverse-Wishart）分布。
%(a mixing proportion)

\subsection{社群的层次发现算法}
针对社群的层次发现场景，信息聚类和 GN 算法均是不含
超参的。
BHCD 算法的超参数较多，
我们取 $\delta=0.2, \lambda=0.85$，其他参数取自文章\citet{RN23}
中的默认值。
\subsection{异常值检测算法}
除信息检测算法外，我们使用 scikit-learn 算法包提供
的接口，除接口默认的参数外，各算法的超参数如表\ref{tab:outlier_detection_alg_hyperparameter}
所示。信息检测算法根据式\ref{eq:outlier_detection_proposal}介绍的规则自动判断异常值点的数量，
其他算法则根据已知的异常值点的数量对异常值进行检测。

\begin{table}[!ht]
  \begin{adjustbox}{width=\columnwidth,center}
  \begin{tabular}{|l|c|c|c|c|c|c|}
  \hline
   异常值检测算法  &   参数名称 &
   GaussianBlob &  Moon &  Lymphography &   Glass &   Ionosphere \\
  \hline
   \multirow{2}{*}{信息聚类}  & affinity
   & rbf & rbf & laplacian
   & rbf & rbf \\
   \cline{2-7}
   & $\gamma$ & 0.5 & 0.8 & 0.1 & 0.05 & 0.29 \\
   \hline
   局部异常因子  &  
   邻居数量 & 20 &  10
   &  60
   & 2 &   9 \\
   \hline
   \multirow{2}{*}{一类支持向量机}  & 
   affinity & rbf &  rbf
   & rbf
   & rbf & rbf \\
   \cline{2-7}
   & $\gamma$ & 0.1 & 0.1 & 0.1 & 0.1 & 0.4\\
  \hline
  \end{tabular}
\end{adjustbox}
\caption{异常值检测算法超参数}\label{tab:outlier_detection_alg_hyperparameter}
\end{table}


\section{Proof of Theorem \ref{thm:phase_transition}}
\label{sec:appendix_theorem_proof_phase_trans}

\begin{proof}[Proof of Lemma \ref{lem:lemmaDiff}]
	First we rewrite the energy term in \eqref{eq:energy} as:
	\begin{equation*}
	H(\bar{\sigma}) = \gamma \frac{\log n}{n} \sum_{i < j} \delta(\bar{\sigma}_i, \bar{\sigma}_j)
	- (1 + \gamma\frac{\log n}{n}) \sum_{ \{i, j\} \in E(G)} \delta(\bar{\sigma}_i, \bar{\sigma}_j)
	\end{equation*}
	
	Then calculating the energy difference term by:
	\begin{align*}
	H(\bar{\sigma}') - H(\bar{\sigma}) &= (1 + \gamma\frac{\log n}{n}) \\
	&\cdot \sum_{i \in N_r(G)} (\delta(\bar{\sigma}_r, \bar{\sigma}_i) -
	\delta(\omega^s \cdot \bar{\sigma}_r, \bar{\sigma}_i)) \\
	&+ \gamma \frac{\log n}{n}\sum_{i\neq r}
	( \delta(\omega^s \cdot \bar{\sigma}_r, \bar{\sigma}_i) -
	\delta( \bar{\sigma}_r, \bar{\sigma}_i) ) \\
	& = (1 + \gamma\frac{\log n}{n})\sum_{i \in N_r(G)} J_s(\bar{\sigma}_r, \bar{\sigma}_i) \\
	&+ \gamma \frac{\log n}{n}\sum_{i=1}^n
	( \delta(\omega^s \cdot \bar{\sigma}_r, \bar{\sigma}_i) -
	\delta( \bar{\sigma}_r, \bar{\sigma}_i) +1) \\
	&= (1+\gamma \frac{\log n}{n})\sum_{i \in N_r(G)} J_s(\bar{\sigma}_r, \bar{\sigma}_i)\\
	&+ \gamma \frac{\log n}{n} (m(\omega^s \cdot \bar{\sigma}_r)-m(\bar{\sigma}_r)+1)
	\end{align*}
\end{proof}
