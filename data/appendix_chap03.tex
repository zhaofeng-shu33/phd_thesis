
\section{定理证明}

%附录是与论文内容密切相关、但编入正文又影响整篇论文编排的条理和逻辑性的资料，例如某些重要的数据表格、计算程序、统计表等，是论文主体的补充内容，可根据需要设置。
\subsection{定理\ref{thm:weak_independence_equivalent}的证明}
\begin{proof}[定理\ref{thm:weak_independence_equivalent}的证明]
  由$\epsilon$邻域的定义\ref{def:eps_neighborhood}，
  $P_{Y|X=x}(y) = P_Y(y) + \sqrt{P_Y(y)}\phi_{Y|X=x}(y)
  \epsilon$。令$\phi_{XY}(x,y)=\sqrt{P_X(x)}\phi_{Y|X=x}(y)$，
  则有
  $P_{XY}(x,y) = P_X(x)P_Y(y) + \sqrt{P_X(x)}\sqrt{P_Y(y)}\phi_{XY}(x,y)
  \epsilon$。
  假设$x\in \mathcal{X}$ 且 $y\in \mathcal{Y}$，
  $\mathcal{X}, \mathcal{Y}$ 均为有限的字母集。
  $\phi_{XY}$ 是 $|\mathcal{X}| \times |\mathcal{Y}|$
  的矩阵，其秩为 $r$。$\phi_{XY}$可以通过奇异值分解的形式写成
  $\frac{1}{r}\sum_{i=1}^r \phi_i \psi^T_i$，其中$\phi, \psi$
  是长度分别为$|\mathcal{X}|, |\mathcal{Y}|$的
  列向量。构造 $U$ 是$\{1, 2, \dots, 2r\}$ 上的均匀分布。
  而$Z_1, Z_2$ 做如下构造：
  \begin{align*}
    P(Z_1=x|U=i) &= P_X(x) + (-1)^i\sqrt{P_X(x)}\phi_{\lceil i/2 \rceil}(x) \sqrt{\epsilon}, x \in \mathcal{X} \\
    P(Z_2=y|U=i) &= P_Y(y) + (-1)^i\sqrt{P_Y(y)}\psi_{\lceil i/2 \rceil}(y) \sqrt{\epsilon}, y \in \mathcal{Y}
  \end{align*}
  $Z_1 | U$ 与$Z_2 | U$ 独立，因此，
  $Z_1, Z_2$ 的联合分布为：
  \begin{align*}
  P(Z_1=x, Z_2=y)& =\sum_{i=1}^{2r}P(U=i)P(Z_1=x|U=i)P(Z_2=y|U=i)\\
  &=P_X(x)P_Y(y) + \sqrt{P_X(x)}\sqrt{P_Y(y)}\frac{\epsilon}{r}
  \sum_{i=1}^{r}\phi_i(x)
  \psi(y) =P(X=x,Y=y)
  \end{align*}
  故$Z_1, Z_2$与$X,Y$具有相同的分布。
  不难验证$(Z_1, Z_2)|U$在$(Z_1, Z_2)$的$\sqrt{\epsilon}$邻域内，
  故结论得证。
  \end{proof}

\subsection{定理\ref{thm:DPX}的证明}

\begin{lemma}\label{lem:xyz}
	若 $(X,Y)$ 与 $Z$ $\epsilon$-弱独立，
  则 $X$ 与 $Z$ $\epsilon$-弱独立。
\end{lemma}
\begin{proof}
	由两随机变量$\epsilon$-弱独立的定义式\ref{def:weak_indepedent}，
  我们有
	\begin{equation}\label{eq:pxy_eps}
	P_{X,Y|Z=z}(x,y) = P_{X,Y}(x,y)\left(1+\epsilon \frac{\phi_z(x,y)}{\sqrt{P_{X,Y}(x,y)}}
  \right), z \in \mathcal{Z}
	\end{equation}
	对式\ref{eq:pxy_eps} 关于 $y\in \mathcal{Y}$ 求和我们有
	\begin{equation}
	P_{X|Z=z}(x) = P_X(x)\left(1+\epsilon\frac{\tilde{\phi}_z(x)}{\sqrt{P_X(x)}} \right),
	\textrm{ 其中 } \tilde{\phi}_z(x) = \frac{\sum_{y\in \mathcal{Y}} \sqrt{P_{X,Y}(x,y) }\phi_z(x,y)}{\sqrt{P_X(x)}}
	\end{equation}
	由 柯西不等式，$||\tilde{\phi}_z(x)||^2 \leq \frac{1}{P_X(x)}
	\sum_{y\in \mathcal{Y}}(P_{X,Y}(x,y))
	\sum_{y\in \mathcal{Y}} \phi_z^2(x,y) \leq 1
	$
	从而推出 $X$  与 $Z$ 弱独立。
\end{proof}
\begin{proof}[定理\ref{thm:DPX}的证明]
  由多个随机变量弱独立的定义式\ref{def:general}，
  我们可以找到 一个在字母集 $\{1, 2,\dots, K\}$上的
  离散分布 $U$， 使得 $Z_1, \dots, Z_n$
  关于 $U$ 条件独立。不失一般性，我们假设
  $(Z_1, \dots, Z_n)$ $\epsilon^n$-弱独立。
  则 $(Z_1, \dots, Z_n)$ 和 $U$ $\epsilon$-弱独立，
  由引理\ref{lem:xyz} 可得 $Z_i$
  和 $U$ $\epsilon$-弱独立，也即有 
\begin{equation}\label{XUk}
P_{Z_i | U=k}(z) = P_{Z_i} (z) \left( 1 + \epsilon {\phi^{(k,i)}(z) \over \sqrt{P_{Z_i}(z)}} \right)
\end{equation}
利用条件独立有
\begin{align}
P_{Z_i, Z_j | U = k}(z_i, z_j)
=& P_{Z_i | U=k}(z_i)
P_{Z_j | U=k}(z_j) \notag \\
=& P_{Z_i}(z_i)P_{Z_j}(z_j)
\left(1 + \epsilon
\left(\frac{\phi^{(k,i)}(z_i)}{\sqrt{P_{Z_i}(z_i)}}
+ \frac{\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_j}(z_j)}}
\right) +
\epsilon^2\frac{\phi^{(k,i)}(z_i)
	\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
  \right)
  \label{eq:XiXj}
\end{align}
又因为
\begin{align*}
P_{Z_i}(z) &= \sum_{k=1}^{K} P_{Z_i | U=k}(z) P_U(u_k) \\
& =  \sum_{k=1}^{K}P_U(u_k)P_{Z_i} (z)
\left( 1 + \epsilon {\phi^{(k,i)}(z) \over \sqrt{P_{Z_i}(z)}} 
\right) \textrm{ from } \eqref{XUk}\\
\Rightarrow & \sum_{k=1}^{K} P_U(u_k){\phi^{(k, i)}(z) \over \sqrt{P_{Z_i}(z)}} =0,\forall i, z\in \mathcal{Z}
\end{align*}
因此 \eqref{eq:XiXj} 化简为
\begin{equation}\label{eq:PXiXj}
P_{Z_i, Z_j}(z_i, z_j) = P_{Z_i}(z_i)
P_{Z_j}(z_j) \left(
  1+\epsilon^2 \sum_{k=1}^K P_U(u_k)
\frac{\phi^{(k,i)}(z_i)
	\phi^{(k,j)}(z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
  \right)
\end{equation}
对于2个以上的随机变量:
\begin{align*}
P_{Z_1,\dots,Z_n}(z_1,\dots,z_n)  &= \sum_{k=1}^{K} P_{Z_1,\dots,Z_n | U=k}(z_1,\dots,z_n) P_U(u_k) \\
&=  \sum_{k=1}^{K}P_U(u_k) \prod_{i=1}^n P_{Z_i|U=k}(z_i)\\
&= \sum_{k=1}^{K} P_U(u_k)\prod_{i=1}^n \left(P_{Z_i} (z_i)( 1 + \epsilon {\phi^{(k,i)}(z_i ) \over \sqrt{P_{Z_i}(z_i)}} )\right)\\
&=  \sum_{k=1}^{K}P_U(u_k) (\prod_{i=1}^n  P_{Z_i} (z_i))
\left( 1 + \epsilon\sum_{i=1}^n {\phi^{(k,i)}(z_i) \over \sqrt{P_{Z_i}(z_i)}} + \epsilon^2\sum_{i\neq j}{\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)+o(\epsilon^2) \\
&= (\prod_{i=1}^n  P_{Z_i} (z_i))
\Big(1+\epsilon\sum_{i=1}^n \sum_{k=1}^{K} P_U(u_k){\phi^{(k,i)}(z_i) \over \sqrt{P_{Z_i}(z_i)}} \\
&+\epsilon^2 \sum_{k=1}^{K} P_U(u_k)\sum_{i\neq j}{\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } 
\Big) + o(\epsilon^2)\\
&= (\prod_{i=1}^n  P_{Z_i} (z_i))
\left(1 +\epsilon^2\sum_{i\neq j} \sum_{k=1}^{K}P_U(u_k){\phi^{(k,i)}(z_i)\phi^{(k,j)}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right) + o(\epsilon^2)
\end{align*}
由 \eqref{eq:PXiXj}，
令 $B_{ij}(z_i, z_j)={P_{Z_i, Z_j}(z_i,z_j) - P_{Z_i}(z_i)P_{Z_j}(z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}} $ 可得:
\begin{align}
\epsilon^2\sum_{k=1}^{K}P_U(u_k)
{\phi^{k,i}(z_i)\phi^{k,j}(z_j)\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } & = {P_{Z_i, Z_j}(z_i, z_j) - P_{Z_i}(z_i)P_{Z_j}(z_j) \over P_{Z_i}(z_i)P_{Z_j}(z_j)} \notag\\
& = {B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} } \label{eq:Bsecond}
\end{align}
因此，我们有
\begin{equation}\label{eq:sep}
P_{Z_1,\dots,Z_n}(z_1,\dots,z_n) =  (\prod_{i=1}^n  P_{Z_i} (z_i))\left( 1 + \sum_{i\neq j}{B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right) +o(\epsilon^2)
\end{equation}
因此 $P_{Z_1,\dots, Z_n}$ 在 $P_{Z_1}\dots P_{Z_n}$ 的
$\epsilon$ 邻域内，且特征函数是
$$\phi(z_1,\dots, z_n)=
\sqrt{P_{Z_1}(z_1)\dots P_{Z_n}(z_n)}
\left(\sum_{i\neq j}{B_{ij}(z_i, z_j) 
\over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)
+o(\epsilon^2)$$

由 信息几何的式\eqref{eq:approx:ig} 可得
\begin{align*}
D(P_{Z_1,\dots, Z_n}|| P_{Z_1}\dots P_{Z_n}) & ={1 \over 2} \sum_{z_1,\dots,z_n}\phi^2(z_1,\dots, z_n) \\
& = {1\over 2}\sum_{z_1,\dots,z_n} (\prod_{i=1}^n  P_{Z_i} (z_i)) \left(\sum_{i\neq j}{B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)^2 +o(\epsilon^2) 
\end{align*}
由 $B_{ij}$
的定义式 \eqref{eq:Ixy}，
上式可化为对 $\norm{B_{ij}}^2_F$
的求和(平方和中的交叉项外面再求和得零)。
因此，对于分割$\P=\{\{i\},i\in V\}$ 我们得到
\begin{equation}
D(P_{Z_1,\dots, Z_n}|| P_{Z_1}\dots P_{Z_n}) =   {1 \over 2} \sum_{i\neq j} \norm{B_{ij}}^2_F + o(\epsilon^2)
\end{equation}
对于任意的分割 $\P$，
由式\eqref{eq:sep}可得，对于 $C\in \P$，
我们有
\begin{equation}
P_{Z_C}(z_C) = \prod_{i\in C} P_{Z_i}(z_i)
\left(1 + \epsilon^2 \sum_{i\neq j,i,j\in C} \frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
\right) + o(\epsilon^2)
\end{equation}
将上式相乘可得:
\begin{equation}
\prod_{C\in \P}P_{Z_C}(z_C) = \prod_{i=1}^n P_{Z_i}(z_i)
\left(1+\epsilon^2 \sum_{C\in\P}\sum_{i\neq j,i,j\in C}\frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}
\right) + o(\epsilon^2)
\end{equation}
所以 $\prod_{C\in \P}P_{Z_C}$ 在 $P_{Z_1}\dots P_{Z_n}$ 的$\epsilon$ 邻域内，
且 $$\phi_{\P}(z_1,\dots, z_n)=
\sqrt{P_{Z_1}(z_1)\dots P_{Z_n}(z_n)}\left(\sum_{C\in\P}\sum_{i\neq j,i,j\in C}\frac{B_{ij}(z_i, z_j)}{\sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)}}\right)+o(\epsilon^2)$$
由  \eqref{eq:approx:ig} 得:
\begin{align*}
D(P_{Z_1,\dots, Z_n}|| \prod_{C\in \P}P_{Z_C}) & ={1 \over 2} \sum_{z_1,\dots,z_n}(\phi(z_1,\dots, z_n)-\phi_{\P}(z_1, \dots, z_n))^2 \\
& = {1\over 2}\sum_{z_1,\dots,z_n} \prod_{i=1}^n  P_{Z_i} (z_i) \left(\sum_{\substack{(i,j) \not\in C\\ C\in \P}} {B_{ij}(z_i, z_j) \over \sqrt{P_{Z_i}(z_i)P_{Z_j}(z_j)} }\right)^2 +o(\epsilon^2) \\
& = \frac{1}{2} \sum_{\substack{(i,j) \not\in C\\ C\in \P}} \norm{B_{ij}}_F^2 + o(\epsilon^2)
\end{align*}
\end{proof}



\subsection{定理\ref{thm:alg_complexity}的证明}
\begin{proof}[定理\ref{thm:alg_complexity}的证明]
  令
  $\mu_i = \frac{n_i}{n} \leq \frac{1}{2}$。
  下面我们使用归纳法证明
  $T(n) = O(n^4)$。
  更具体地，我们将证明 
  $T(n) \leq q C n^4$， 其中 $ q = \frac{16}{5}$。
  $T(3)$ 是一个常数，我们取$C$使得 $T(3)= q C\times 3^4$。
  下面假设
	$T(m) \leq qC m^4$
  对所有 $m \leq n-1$。
  然后 对于 $T(n)$，
	我们首先证明下式成立：
	\begin{equation}\label{eq:outerI}
	\sum_{i=1}^k T(n_i) \leq 10 T(\frac{n}{2})
	\end{equation}
	因为 $\sum_{i=1}^k T(n_i) \leq qC n^4\sum_{i=1}^k u_i^4$ 并且
  从式 \eqref{eq:Tn} 中可得
  $10 T(\frac{n}{2}) \geq 10Cn^4 (\frac{1}{2})^4$ 
	\begin{equation}\label{eq:innerI}
       q\sum_{i=1}^k u_i^4 \leq 10 (\frac{1}{2})^4 
	\end{equation}
	所以我们有 \eqref{eq:innerI} $\Rightarrow$ \eqref{eq:outerI}。
  由定理\ref{thm:alg_complexity} 条件，我们不妨假设
  $u_1\leq u_2 \leq \dots \leq u_k \leq \frac{1}{2}$
  且 $\sum_{i=1}^k u_i = 1$。
  因此，我们有
  $u_1 \leq \frac{1}{k}, u_2 \leq \frac{1}{k-1}, \dots, u_{k-1} \leq \frac{1}{2}$。
	根据
  \begin{equation}\label{eq:outerOne}
	 q[2(\frac{1}{2})^4 + \sum_{i=3}^k (\frac{1}{i})^4] \leq 10 (\frac{1}{2})^4
	\end{equation}
	我们有 \eqref{eq:outerOne} $\Rightarrow$ \eqref{eq:innerI}。
  并且代入$q=\frac{16}{5}$，
  \eqref{eq:outerOne} 等价于
	$\sum_{i=3}^k \left(\frac{1}{i} \right)^4 \leq \frac{9}{8}(\frac{1}{2})^4$
	\begin{align*}
		\sum_{i=3}^k (\frac{1}{i})^4 & < \frac{1}{9}\sum_{i=3}^k \left(\frac{1}{i}
    \right)^2 \\
		& < \frac{1}{9}\sum_{i=3}^k \frac{1}{i(i-1)} \\
		& < \frac{1}{18}
    < \frac{9}{8}\left(\frac{1}{2}
    \right)^4
	\end{align*}
	因此，
  式 \eqref{eq:outerI} 成立。然后
  由 式\eqref{eq:Tn} 和 $T(k) \leq T(\frac{n}{2})$ 可得
	\begin{align}
		T(n)  & \leq Cn^4 + 11T\left(\frac{n}{2} \right) \\
		& \leq C n^4 + 11 q C \left(\frac{n}{2}\right)^4
    = \frac{16}{5} C n^4
	\end{align}
\end{proof}

\subsection{定理\ref{thm:triangle}的证明}
首先我们证明如下引理：
\begin{lemma}\label{thm:trival}
  分割 $\P_k = \{\{1\},\{2\},\dots,\{\abs{V}\}\}$ 
  使得 $\frac{f[\P]}{\abs{\P}-1}$
  最小 当且仅当 条件\eqref{eq:GFP} 成立。
  \begin{equation}\label{eq:GFP}
  \frac{f[\P]}{\abs{\P}-1} \geq \frac{f[\P_k]}{\abs{V}-1} \textrm{ 对于任何 } \P \in \Pi'
  \end{equation}
  \end{lemma}
  \begin{proof}
  由文献\inlinecite{narayanan}中 的定理3可知，
  $h(\lambda)$ 是分段线性函数，
  $h(\lambda)$ 的第一段
  是 $ - \lambda $ 且 
  最后一段是 $ f[\P_k] - \abs{V} \lambda$。
  它们的交点是
  $(\lambda_{+}, -\lambda_{+})$，
  其中
  $\lambda_{+} = \frac{f[\P_k]}{\abs{V}-1}$。
  因为 $\frac{f[\P]}{\abs{\P}-1} \geq \lambda_{+} \iff f[\P] - \abs{\P}\lambda_{+} \geq - \lambda_{+}$，
  方程 \eqref{eq:GFP}
  相当于说 $h(\lambda)$ 在 $\lambda = \lambda_{+}$
  的最小值点是
  $\{V\}$ 或
  $\{\{1\},\{2\},\dots,\{\abs{V}\}\}$
  并且 $h(\lambda)$ 只有两段。
  从几何的观点来看，$\min\frac{f[\P]}{\abs{\P}-1}$
  是 $h(\lambda)$ 第一个分界点，
  该分界点与$h(\lambda)$最后一个分界点
  相等 当且仅当 \eqref{eq:GFP} 成立。
  \end{proof}
  \begin{proof}[定理\ref{thm:triangle}的证明]
    我们将使用归纳法证明对于任意的分割$\P \in \Pi$，
    式\eqref{eq:GF} 成立。
    \begin{equation}\label{eq:GF}
    f[\P] \geq \frac{\abs{\P}-1}{\abs{V}-1} \sum_{(i,j) \in E} w_{ij}
    \end{equation}
    
    然后由引理\ref{thm:trival}
    即可得证。
    
    设 $n=\abs{V}$。
    若 $\abs{\P}=n$，
    易得式 \eqref{eq:GF} 取等号。
    
    假设 式\eqref{eq:GF} 对 任意
    $\abs{\P} \geq k+1(k\geq 2)$成立，
    下面我们讨论 $\P=\{C_1, \dots, C_k\}$
    的情形。
    因为$\P$是非平凡的分割，
    因此存在某个$\abs{C_i}\geq 2$。
    不妨设$\abs{C_1}=n_1\geq 2$，
    构造$\P$的一个细分$\P'$如下：
    $\P_{C_1} = \{\{i\}| i \in C_1\}, \P'=\P_{C_1} \cup \P \backslash \{C_1\}$。
    则我们有 $\abs{\P'} = k+n_1-1$。
    对$\P'$运用 式\eqref{eq:GFP} 有
    \begin{align}\label{eq:PPrelation}
    f[\P'] &
    \geq \frac{k+n_1 -2}{n-1}\sum_{(i,j) \in E} w_{ij} \\
    f[\P] & =f[P'] - \sum_{(i,j) \in E(C_1)} w_{ij}
    \end{align}
    其中
    $E(C_1) =\{ (i,j) |i<j, i, j\in C_1 \}$。
    对任意$k \not\in C_1$运用三角不等式
    $w_{ij} \leq w_{ik} + w_{jk}$，
    并关于所有 $i, j \in C_1, i\neq j$求和，
    我们有
    $$
    \sum_{(i,j) \in E(C_1)} w_{ij} \leq \sum_{(i,j) \in E(C_1)} (w_{ik} + w_{jk}) = (n_1-1)\sum_{i\in C_1} w_{ik}
    $$
    再将上式对所有 $k \not\in C_1$ 求和
    $$
    (n - n_1) \sum_{(i,j) \in E(C_1)} w_{ij} \leq (n_1 - 1) \sum_{i \in C_1, k \not\in C_1} w_{ik}
    $$
    另外，注意到
    \begin{align*}
    \sum_{(i,j) \in E} w_{ij}  & \geq \sum_{(i,j) \in E(C_1)} w_{ij} + \sum_{i\in C_1, k\not\in C_1} w_{ik} \\
    (n_1 - 1)\sum_{(i,j) \in E} w_{ij}  & \geq (n_1 -1 )\sum_{(i,j) \in E(C_1)} w_{ij} + (n_1-1)\sum_{i\in C_1, k\not\in C_1} w_{ik} \\
    & \geq (n_1 -1 )\sum_{(i,j) \in E(C_1)} w_{ij} + (n - n_1) \sum_{(i,j) \in E(C_1)} w_{ij}\\
    & = (n-1) \sum_{(i,j) \in E(C_1)} w_{ij}
    \end{align*}
   因此我们得到 $\sum_{(i,j) \in E(C_1)} w_{ij} \leq \frac{n_1-1}{n-1}\sum_{(i,j) \in E} w_{ij}$。
   从式 \eqref{eq:PPrelation} 可得
    $f[\P] \geq \frac{k-1}{n-1}\sum_{(i,j) \in E} w_{ij}$。
    因此，结论对 $\abs{\P}=k$ 成立。
    \end{proof}
\subsection{定理\ref{thm:main_N}的证明}
    \begin{proof}[定理\ref{thm:main_N}的证明]
      我们首先做出如下的符号约定：
      $w(C) = \displaystyle\sum_{(i,j) \in E(C)} w_{ij},$
      $w(A, C) = \displaystyle\sum_{\substack{i \in A, j \in C \\ (i,j) \in E(V')}} (w_{ij}+w_{ji})$ 且
      $\P_C = \{\{i \}| i \in C \}$。
      假设 $\gamma_N = I(Z_B)$，
      由式 \eqref{eq:largest_threshold} 可得
      $\gamma_N =\frac{f[\P_B]} {\abs{B} -1}$。
      因为 $V' = B \cup \{i'\}$，我们有
      $f[\P_{V'}] = f[\P_B] + \sum_{i \in B}w_{ii'}$。
      
      若 $ \sum_{i \in B} w_{ij} > \gamma_N$， 我们可得
      $$
      \gamma'_N \geq I_{\P_{V'}}(Z_{V'}) = \frac{(\abs{B}-1)\gamma_N
      + \sum_{i \in B}w_{ii'}}{\abs{B}} > \gamma_N
      $$
      
      另一方面， 假设 
      $\gamma'_N = I(Z_K) > \gamma_N$。 则 $K$ 必包含 $i'$。
      若 $K=V'$， 则结论成立。
      否则， 假设 $K = \{i'\} \cup B', B=B'\cup J, J\neq \emptyset$，
      则我们有
      \begin{equation}\label{eq:gammaNF}
      \gamma_N = \frac{w(J,B') + w(J) + w(B')}{ \abs{B'} + \abs{J} - 1 }
      \end{equation}
      因为 $I(Z_K) = I_{\P_K}(Z_K)$ 是最大的，
      我们有 $I_{\P_K}(Z_K) > I_{\P_{V'}}(Z_{V'})$ 且
      $I_{\P_K}(Z_K) \geq I_{\P_{B'}}(Z_{B'})$。
      \begin{align*}
      \frac{w(\{i'\}, B') + w(B')}{\abs{B'}} >& \frac{w(B') + w(J, B') + w(J) + w(\{i'\}, B') + w(\{i'\}, J)}{\abs{B'} + \abs{J}}  \\
      \frac{w(\{i'\}, B') + w(B')}{\abs{B'}} \geq & \frac{w(B')}{\abs{B'} - 1}
      \end{align*}
      于是可得
      \begin{align}
      \abs{J} \left(w(\{i'\}, B') + w(B') \right) > &
      \abs{B'} \left(w(J, B') + w(J) + w(\{i'\}, J) \right)
      \label{eq:target}
      \\
      (\abs{B'} - 1)  w(\{i'\}, B') \geq & w(B') \label{eq:convert}
      \end{align}
      将 式\eqref{eq:convert} 代入 式\eqref{eq:target} 可得
      \begin{equation}\label{eq:summation}
      \abs{J} w(\{i'\}, B') > w(J, B') + w(J) + w(\{i'\}, J)
      \end{equation}
      结合 式\eqref{eq:gammaNF}，
      将 式\eqref{eq:convert} 与 式\eqref{eq:summation} 相加我们可得
      $w(\{i'\}, B') > \gamma_N$。
      所以 $\sum_{j \in B}w_{ii'} > \gamma_N $ 成立。
    \end{proof}
  
